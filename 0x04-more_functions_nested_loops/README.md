more functions and netsed loops
